ssh kmcdermo@lxplus080.cern.ch

#### config from /dev/CMSSW_9_1_0/HLT/V84

cmsrel CMSSW_9_2_0_patch2
cd CMSSW_9_2_0_patch2/src
cmsenv
git cms-init

# L1T
git remote add cms-l1t-offline git@github.com:cms-l1t-offline/cmssw.git
git fetch cms-l1t-offline
git cms-merge-topic -u cms-l1t-offline:l1t-integration-v94.5-CMSSW_9_2_0
git cms-addpkg L1Trigger/L1TCommon
git cms-addpkg L1Trigger/L1TMuon
git clone https://github.com/cms-l1t-offline/L1Trigger-L1TMuon.git L1Trigger/L1TMuon/data

git cms-merge-topic -u 18635
git cms-addpkg L1Trigger/L1TGlobal

# L1T 2017 menu
# to get the updated L1T menu circulated May 17th (L1Menu_Collisions2017_dev_r3)
git clone https://github.com/cms-l1-dpg/2017-pp-menu-dev -b 2017-05-17 ../2017-pp-menu-dev
# alternatively, to checkout the work-in-progress branch (updated without notice!)
# git clone https://github.com/cms-l1-dpg/2017-pp-menu-dev -b work-in-progress ../2017-pp-menu-dev
mkdir -p L1Trigger/L1TGlobal/data/Luminosity/startup
cp ../2017-pp-menu-dev/Apr12/*.xml L1Trigger/L1TGlobal/data/Luminosity/startup/

# HLT
git cms-addpkg HLTrigger/Configuration
git cms-merge-topic -u cms-tsg-storm:for83Xsamples92X
git cms-merge-topic -u cms-tsg-storm:92XMigrateHLTtoCMSSW910
git cms-merge-topic -u 18819

scram b -j 16

### from ntupler twiki
git cms-addpkg GeneratorInterface/GenFilters

git cms-addpkg HLTrigger/HLTanalyzers
git clone https://github.com/cms-steam/HLTrigger temp -b b_2017_90X
cp -r temp/* HLTrigger/
rm -fr temp/

scram b -j 8

#### GetConfig

hltGetConfiguration /users/kmcdermo/TargetPath91X/DisplacedPhotonHT_Controls --globaltag 92X_upgrade2017_TSG_For83XSamples_V3 --process userHLT --mc --unprescale --full --offline --l1-emulator FullSimHcalTP --setup /dev/CMSSW_9_1_0/HLT --input /store/mc/PhaseIFall16DR/QCD_Pt-120to170_EMEnriched_TuneCUETP8M1_13TeV_pythia8/GEN-SIM-RAW/FlatPU28to62HcalNZSRAW_90X_upgrade2017_realistic_v6_C1-v1/00000/00AAEB84-7C07-E711-B9A2-0CC47A7C3572.root  > hlt_userMC.py

#### 

Make sure to get a grid proxy!

Do a test run to make sure it works, at least passing one event. Now we have edit by hand the run_ntupleprod.py.

First, set doL1_Prescales = False, L1_PrescaleColumn = 2, nEvents = -1, and then remove ifs on isMC or not.

Now copy/paste entire hlt_userMC.py into the file.  From here, change:

_customInfo['inputFile' ] = [INPUT_FILES]

and 

process.hltbitanalysis.RunParameters.HistogramFile = cms.untracked.string('OUTPUT_FILE')

and then comment out the other places for input/output files, to be safe (and change maxEvents = -1 everywhere, too)
